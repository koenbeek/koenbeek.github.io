<!DOCTYPE html>
<html lang=”en”>

<head>
    <title>Match Lines</title>
    <meta charset="utf-8">
</head>

<body>
    <h1>Match Lines</h1>

    <label for="pat">Pattern: </label><input type="text" id="pat" size=50>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions/Cheatsheet" target="_blank">cheatsheet</a><br><br>
    <input type="checkbox" id="invert"><label for="invert">Invert match (only keep non-matching lines)</label><br>
    <input type="checkbox" id="ic"><label for="ic">Ignore case</label><br>
    <input type="checkbox" id="match"><label for="match">Only Matching (only keep part that matched)</label>

    <h2>Input </h2>
    <textarea id="intext" rows="10" cols="100"></textarea><br>

    <h2>Output <button onclick="toCP()">Copy to Clipboard</button></h2>
    <textarea id="outtext" rows="10" cols="100" readonly></textarea><br>
</body>
<script type="module">
    import { gE, gV, gC, toCP, doSetup, sErr, sOK } from './js/lib.js';
    function match() {
        var lines = gV("intext").split('\n');
        try {
            var re = new RegExp(gV("pat"), gC("ic") ? "i" : "")
            lines = lines.filter(line => (line.match(re) != null) != gC("invert"));
            if (gC("match") && !gC("invert")) { lines = lines.map(line => line.match(re)[0]) }

            gE("outtext").value = lines.join("\n");
            sOK("pat");
        } catch (e) {
            sErr("pat")
        }
    }
    doSetup(match);
</script>

</html>